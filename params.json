{"name":"X-evo","tagline":"Механизм расширения для MODX Evolution / Clipper CMS","body":"# Предыстория\r\n\r\nИдея давно витала в воздухе. Качество и структура php кода в ядре Ево никак не подразумевали удобного программирования. Сама идеология работы modx подразумевает, что сайт собирается из кусков php кода, написанных как угодно. Однако, когда из проекта в проект тянутся одни и те же стандартные куски кода для нестандартных сниппетов, начинаешь сильно нервничать.\r\n\r\nА тут еще и сам php не стоит на месте. Появляются возможности, которых просто _очень_ не хватает в разработке. В итоге (буду говорить только о себе) появлялись различные способы расширить возможности Ево за счет силового добавления в объект $modx непредусмотренных атрибутов и методов. Хоть это и заставляло кривиться любителей чистоты ООП кода, но работало. \r\n\r\nИ вот настало время, когда появился composer и удобное управление классами. И внедрять сторонние библиотеки в modx стало невозможно, а не внедрять - слишком накладно. \r\n\r\n# История\r\n\r\nВ результате сравнительно небольших усилий была спроектирована структура построения механизма расширений именно с точки зрения php разработчика. Суть вот в  чем.\r\n\r\nПри запуске modx стартует плагин, который запускает автолоадер. Сравнительно небольшие соглашения по размещению файлов с библиотеками позволяют в этом же плагине через пространства имен подключать практически любые сторонние библиотеки. Управляет этим всем очень простой код, который я пока приводить и комментировать не буду; скорее всего все это еще будет меняться, так как есть желание в будущем прикрутить под него нормальный механизм установки/обновления. \r\n\r\nВ качестве примера работы механизма расширений выбран проект https://github.com/Andre-487/php_rutils - небольшая библиотека, которая позволяет работать с русским текстом в датах, временных интервалах, переводить числа в пропись и немного типографировать. После несложной регистрации в плагине:\r\n\r\n```\r\n$loader->addNamespace('Modx\\Ext\\Rutils', MODX_BASE_PATH.'assets/extensions/Rutils/lib');\r\n```\r\n\r\nстановится возможным в любом сниппете написать следующее:\r\n\r\n```\r\n<?php\r\nuse Modx\\Ext\\Rutils\\RUtils;\r\nuse Modx\\Ext\\Rutils\\TypoRules;\r\n\r\necho $numeral->getInWordsFloat(100.025),'<br><br>';\r\n\r\n//Result: сто целых двадцать пять тысячных\r\n```\r\n\r\nСобственно, пока это все. В планах (собственно, сейчас идет разработка) инструментарий для управления каталогами.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}